


# BEGIN LBCWpFastestCache
<FilesMatch "\.(webm|ogg|mp4|ico|pdf|flv|jpg|jpeg|png|gif|webp|js|css|swf|x-html|css|xml|js|woff|woff2|ttf|svg|eot)(\.gz)?$">
<IfModule mod_expires.c>
AddType application/font-woff2 .woff2
ExpiresActive On
ExpiresDefault A0
ExpiresByType video/webm A2592000
ExpiresByType video/ogg A2592000
ExpiresByType video/mp4 A2592000
ExpiresByType image/webp A2592000
ExpiresByType image/gif A2592000
ExpiresByType image/png A2592000
ExpiresByType image/jpg A2592000
ExpiresByType image/jpeg A2592000
ExpiresByType image/ico A2592000
ExpiresByType image/svg+xml A2592000
ExpiresByType text/css A2592000
ExpiresByType text/javascript A2592000
ExpiresByType application/javascript A2592000
ExpiresByType application/x-javascript A2592000
ExpiresByType application/font-woff2 A2592000
</IfModule>
<IfModule mod_headers.c>
Header set Expires "max-age=2592000, public"
Header unset ETag
Header set Connection keep-alive
FileETag None
</IfModule>
</FilesMatch>
# END LBCWpFastestCache

<IfModule mod_expires.c>
  ExpiresActive On

  # Audio
  ExpiresByType audio/mpeg "access plus 1 year"
  ExpiresByType audio/mpeg3 "access plus 1 year"
</IfModule>

<IfModule mod_rewrite.c>
  RewriteEngine On

  # TS 16 Nov 18 Must appear here not with other CPanels, unclear why
  RewriteCond %{HTTP_HOST} ^corshambaptists\.org$ [OR]
  RewriteCond %{HTTP_HOST} ^www\.corshambaptists\.org$
  RewriteRule ^preferences$ "https\:\/\/corshambaptists\.org\/privacy\-notice\/update\-your\-preferences\/" [R=301,L]

  # TS 06 Feb 19 Protect church directory or other media from direct access
  RewriteCond %{HTTP_REFERER} !^https://(www\.)?corshambaptists\.org/ [NC]
  RewriteCond %{REQUEST_URI} !hotlink\.(gif|png|jpg|doc|xls|pdf|html|htm|xlsx|docx|mp4|mov) [NC]
  RewriteCond %{HTTP_COOKIE} !^.*wordpress_logged_in.*$ [NC]
  RewriteRule .*\.(gif|png|jpg|doc|xls|pdf|html|htm|xlsx|docx|mp4|mov)$ https://corshambaptists.org/ [NC]
</IfModule>

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress

# Wordfence WAF
<IfModule LiteSpeed>
php_value auto_prepend_file '/home/corshamb/public_html/wordfence-waf.php'
</IfModule>
<Files ".user.ini">
<IfModule mod_authz_core.c>
	Require all denied
</IfModule>
<IfModule !mod_authz_core.c>
	Order deny,allow
	Deny from all
</IfModule>
</Files>
# END Wordfence WAF

# BEGIN litespeed noabort
# See https://www.wordfence.com/help/advanced/system-requirements/litespeed/

RewriteEngine On
RewriteRule .* - [E=noabort:1]

# END litespeed noabort

# Beyond here is added by CPanel
RewriteCond %{HTTP_HOST} ^debtadvicecentre\.org\.uk$ [OR]
RewriteCond %{HTTP_HOST} ^www\.debtadvicecentre\.org\.uk$
RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
RewriteCond %{REQUEST_URI} !^/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
RewriteRule ^/?$ "http\:\/\/corshammoneyanddebtadvicecentre\.co\.uk\/" [R=301,L]

RewriteCond %{HTTP_HOST} ^priorystreetbaptistchurch\.org\.uk$ [OR]
RewriteCond %{HTTP_HOST} ^www\.priorystreetbaptistchurch\.org\.uk$
RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
RewriteCond %{REQUEST_URI} !^/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
RewriteRule ^/?$ "http\:\/\/corshambaptists\.org\/" [R=301,L]
RewriteCond %{HTTP_HOST} ^corshambaptists\.org$ [OR]
RewriteCond %{HTTP_HOST} ^www\.corshambaptists\.org$
RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
RewriteCond %{REQUEST_URI} !^/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
RewriteRule ^(.*)$ "https\:\/\/corshambaptists\.org\/$1" [R=301,L]
RewriteCond %{HTTP_HOST} ^.*$
RewriteCond %{REQUEST_URI} !^/[0-9]+\..+\.cpaneldcv$
RewriteCond %{REQUEST_URI} !^/\.well-known/acme-challenge/.+$
RewriteCond %{REQUEST_URI} !^/\.well-known/pki-validation/[A-F0-9]{32}\.txt(?:\ Comodo\ DCV)?$
RewriteRule ^sermon\/$ "https\:\/\/corshambaptists\.org\/teaching\/feed\/" [R=301,L]

